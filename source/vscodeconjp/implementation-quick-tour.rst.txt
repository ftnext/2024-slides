ã“ã‚Œã‚‰ã®ã‚³ãƒãƒ³ãƒ‰ã¯ã©ã†å®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ï¼Ÿ
======================================================================

* VS Codeã®å®Ÿè£…ï¼ˆTypeScriptï¼‰ã‚’è¦‹ã¦ã„ããƒ‘ãƒ¼ãƒˆ
* **ã‚³ãƒãƒ³ãƒ‰ã”ã¨ã«ã‚¯ãƒ©ã‚¹ãŒã‚ã‚‹**

``registerEditorAction()`` é–¢æ•°
--------------------------------------------------

.. code-block:: typescript

    registerEditorAction(LowerCaseAction);

https://github.com/microsoft/vscode/blob/1.88.1/src/vs/editor/contrib/linesOperations/browser/linesOperations.ts#L1302-L1320

â€»ã‚³ãƒãƒ³ãƒ‰ãƒ‘ãƒ¬ãƒƒãƒˆã§æä¾›ã•ã‚Œã‚‹ä»•çµ„ã¿ã¯ã€ã“ã“ã£ã½ã„ãã‚‰ã„ã«ã¨ã©ã‚ã¾ã™

:guilabel:`Transform to` ã‚³ãƒãƒ³ãƒ‰ã«å¯¾å¿œã™ã‚‹ã‚¯ãƒ©ã‚¹
--------------------------------------------------

* ``UpperCaseAction``
* ``LowerCaseAction``
* ``TitleCaseAction``
* ``SnakeCaseAction``
* ``CamelCaseAction``
* ``PascalCaseAction``
* ``KebabCaseAction``

å…±é€šã®ã‚¹ãƒ¼ãƒ‘ãƒ¼ã‚¯ãƒ©ã‚¹ ``AbstractCaseAction``
--------------------------------------------------

.. code-block:: typescript

    // https://github.com/microsoft/vscode/blob/1.88.1/src/vs/editor/contrib/linesOperations/browser/linesOperations.ts#L1088
    export class LowerCaseAction extends AbstractCaseAction {
        // çœç•¥
    }

* Caseã«é–¢ã™ã‚‹ **æŠ½è±¡** Action
* ã‚µãƒ–ã‚¯ãƒ©ã‚¹ã§å…·ä½“ã®Actionã‚’å®Ÿè£…ã™ã‚‹ï¼ˆä¾‹ï¼šå°æ–‡å­—ã«ã™ã‚‹ï¼‰

``AbstractCaseAction`` ã¾ã§ã®ç¶™æ‰¿é–¢ä¿‚ ğŸƒâ€â™‚ï¸
----------------------------------------------------------------------

.. image:: ../_static/vscodeconjp/InheritanceToAbstractCaseAction.png

`ãƒ¡ãƒ¢ <https://scrapbox.io/nikkie-memos/AbstractCaseAction%E3%81%AB%E8%87%B3%E3%82%8B%E7%B6%99%E6%89%BF%E9%96%A2%E4%BF%82>`__

``AbstractCaseAction`` ã¯GoFã® *Template Method* ãƒ‘ã‚¿ãƒ¼ãƒ³
----------------------------------------------------------------------

.. code-block:: typescript

    // https://github.com/microsoft/vscode/blob/1.88.1/src/vs/editor/contrib/linesOperations/browser/linesOperations.ts#L1032
    export abstract class AbstractCaseAction extends EditorAction {
            public run(_accessor: ServicesAccessor, editor: ICodeEditor): void {
                // å‡¦ç†ã®ä¸­ã§ _modifyText ãŒå‘¼ã°ã‚Œã‚‹
            }

            protected abstract _modifyText(text: string, wordSeparators: string): string;
    }

**ç©´åŸ‹ã‚å•é¡Œ** ã«ãªã£ã¦ã„ã‚‹
------------------------------------------------------------

* ``_modifyText`` ï¼š **ãƒ†ã‚­ã‚¹ãƒˆã®å¤‰æ›´æ–¹æ³•ã ã‘**ã€å…·ä½“ã®Caseã®Actionã§åŸ‹ã‚ã‚Œã°ã‚ˆã„
* å‚è€ƒ `èª­æ›¸ãƒ­ã‚° | #ã¡ã‚‡ã†ãœã¤æœ¬ ç¬¬8ç«  Template Methodãƒ‘ã‚¿ãƒ¼ãƒ³ ã€œç©´åŸ‹ã‚å•é¡Œã«ã™ã‚‹ã€œ <https://nikkie-ftnext.hatenablog.com/entry/the-transcendent-book-chapter8-design-patterns-template-method>`__

``_modifyText()`` ã®å®Ÿè£…ã‚’è¦‹ã‚‹
------------------------------------------------------------

* ``LowerCaseAction``
* ``TitleCaseAction``

1ï¸âƒ£ ``LowerCaseAction``
======================================================================

* **JavaScriptã®ãƒ¡ã‚½ãƒƒãƒ‰** ã‚’ä½¿ã†å®Ÿè£…ï¼ˆ ``UpperCaseAction`` ã‚‚åŒæ§˜ï¼‰
* ï¼ˆç§ã®ç†è§£ãŒé›‘ã™ãã‚‹ã‹ã‚‚ã§ã™ãŒã€ï¼‰TypeScriptã¯å‹ä»˜ãã®JavaScript

.. https://twitter.com/ftnext/status/1603355872809263104

ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã‚ˆã‚Š
--------------------------------------------------

``'HELLO WORLD'`` â¡ï¸ ``'hello world'``

https://github.com/microsoft/vscode/blob/1.88.1/src/vs/editor/contrib/linesOperations/test/browser/linesOperations.test.ts#L677

ã“ã®ãƒ¡ã‚½ãƒƒãƒ‰ã§å®Ÿè£…ï¼š ``toLocaleLowerCase()``
--------------------------------------------------

    å‘¼ã³å‡ºã—ãŸæ–‡å­—åˆ—ã®å€¤ã‚’ã€ãƒ­ã‚±ãƒ¼ãƒ«ã«ä¾å­˜ã—ãŸå¯¾å¿œä»˜ã‘ã«åŸºã¥ã„ã¦å°æ–‡å­—ã«å¤‰æ›ã—ã¦è¿”ã—ã¾ã™ã€‚

MDN `String.prototype.toLocaleLowerCase() <https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/String/toLocaleLowerCase>`__

``LowerCaseAction`` ã® ``_modifyText()``
--------------------------------------------------

.. code-block:: typescript

    // https://github.com/microsoft/vscode/blob/1.88.1/src/vs/editor/contrib/linesOperations/browser/linesOperations.ts#L1098-L1100
	protected _modifyText(text: string, wordSeparators: string): string {
		return text.toLocaleLowerCase();
	}

2ï¸âƒ£ ``TitleCaseAction``
======================================================================

* **æ­£è¦è¡¨ç¾** ã‚’ä½¿ã†å®Ÿè£…
* ``SnakeCaseAction`` ãªã©ãªã©ã‚‚åŒæ§˜

ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã‚ˆã‚Š
--------------------------------------------------

.. list-table::

    * - å…¥åŠ›
      - å‡ºåŠ›
    * - ``'HELLO WORLD'``
      - ``'Hello World'``
    * - ``'foO\'baR\'BaZ'``
      - ``'Foo\'bar\'baz'``
    * - ``'\'physician\'s assistant\''``
      - ``'\'Physician\'s Assistant\''``

https://github.com/microsoft/vscode/blob/1.88.1/src/vs/editor/contrib/linesOperations/test/browser/linesOperations.test.ts#L790

æ­£è¦è¡¨ç¾ã¯ã€ã“ã‚Œã ï¼ï¼
--------------------------------------------------

.. code-block:: typescript

    new RegExp('(^|[^\\p{L}\\p{N}\']|((^|\\P{L})\'))\\p{L}', 'gmu')

https://github.com/microsoft/vscode/blob/1.88.1/src/vs/editor/contrib/linesOperations/browser/linesOperations.ts#L1135

æ­£è¦è¡¨ç¾ãƒªãƒ†ãƒ©ãƒ«ã®ä½œæˆã¯ **2é€šã‚Š**
--------------------------------------------------

* ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã§å›²ã‚€ ``/ab+c/g``
* ``new RegExp("ab+c", "g")`` ï¼ˆğŸ‘ˆä»Šå›ã¯ã“ã¡ã‚‰ï¼‰

MDN `æ­£è¦è¡¨ç¾ã®ä½œæˆ <https://developer.mozilla.org/ja/docs/Web/JavaScript/Guide/Regular_Expressions#%E6%AD%A3%E8%A6%8F%E8%A1%A8%E7%8F%BE%E3%81%AE%E4%BD%9C%E6%88%90>`__

``RegExp`` ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã®å¼•æ•°
--------------------------------------------------

* ç¬¬1å¼•æ•°ãŒãƒ‘ã‚¿ãƒ¼ãƒ³

    * ``\\p`` ã¯ ``\p`` ã® **ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—**

* ç¬¬2å¼•æ•°ãŒãƒ•ãƒ©ã‚°

    * ã‚°ãƒ­ãƒ¼ãƒãƒ«æ¤œç´¢(g)ãƒ»è¤‡æ•°è¡Œã®æ¤œç´¢(m)ãƒ»unicode(u)

ç‹¬è‡ªã‚¯ãƒ©ã‚¹ ``BackwardsCompatibleRegExp`` ğŸƒâ€â™‚ï¸
--------------------------------------------------

* æ­£ç¢ºã«ã¯ã€ ``RegExp`` ã‚’è¿”ã™ ``BackwardsCompatibleRegExp`` ã‚’å®šç¾©ã—ãŸå®Ÿè£…
* ``RegExp`` ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä½œæˆæ™‚ã«ä¾‹å¤–ã‚’é€å‡ºã—ãŸã‚‰ã€æ¡ã‚Šã¤ã¶ã—ã¦ ``null`` ã‚’è¿”ã™ï¼ˆï¼å¾Œæ–¹äº’æ›ï¼‰

æ­£è¦è¡¨ç¾ã‚’ä½¿ã£ãŸ ``_modifyText()``
======================================================================

.. code-block:: typescript

    // https://github.com/microsoft/vscode/blob/1.88.1/src/vs/editor/contrib/linesOperations/browser/linesOperations.ts#L1146-L1155
    protected _modifyText(text: string, wordSeparators: string): string {
        // çœç•¥
        return text
                .toLocaleLowerCase()
                .replace(titleBoundary, (b) => b.toLocaleUpperCase());
    }

æ­£è¦è¡¨ç¾ã‚’ä½¿ã£ãŸ ``replace()``
--------------------------------------------------

* ç½®æ›æ–‡å­—åˆ—ã¨ã—ã¦é–¢æ•°ã‚’æŒ‡å®šã€‚ã‚·ã‚°ãƒãƒãƒ£ã¯ ``b`` ã®ã¿
* ``b`` ã¯ **æ­£è¦è¡¨ç¾ã«ä¸€è‡´ã—ãŸæ–‡å­—åˆ—**
* ã‚­ãƒ£ãƒ—ãƒãƒ£ã‚°ãƒ«ãƒ¼ãƒ—ã® ``()`` ã‚’ï¼ˆå¹¾é‡ã‚‚ï¼‰å«ã‚€ãŒã€ã“ã®replaceã§ã¯ç„¡è¦–

MDN `ç½®æ›æ–‡å­—åˆ—ã¨ã—ã¦ã®é–¢æ•°ã®æŒ‡å®š <https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/String/replace#%E7%BD%AE%E6%8F%9B%E6%96%87%E5%AD%97%E5%88%97%E3%81%A8%E3%81%97%E3%81%A6%E3%81%AE%E9%96%A2%E6%95%B0%E3%81%AE%E6%8C%87%E5%AE%9A>`__

æ­£è¦è¡¨ç¾ ``'(^|[^\\p{L}\\p{N}\']|((^|\\P{L})\'))\\p{L}'`` ğŸ¤¯
======================================================================

.. code-block:: javascript

    new RegExp('(^|[^\\p{L}\\p{N}\']|((^|\\P{L})\'))\\p{L}', 'gmu');
    // /(^|[^\p{L}\p{N}']|((^|\P{L})'))\p{L}/gmu

* ``titleBoundary`` ã¨å‘¼ã°ã‚Œã‚‹
* ï¼ˆå†æ²ï¼‰ ``\`` ã‚’ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã™ã‚‹ãŸã‚ã« ``\\``

``\p{L}``
--------------------------------------------------

* `Unicodeæ–‡å­—ã‚¯ãƒ©ã‚¹ã‚¨ã‚¹ã‚±ãƒ¼ãƒ— <https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Regular_expressions/Unicode_character_class_escape>`__
* ä¸€èˆ¬ã‚«ãƒ†ã‚´ãƒªãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒ *L* etter ã® **Unicodeæ–‡å­—ã®é›†åˆ**
* **æ–‡å­—ã«ãƒãƒƒãƒ** ã™ã‚‹ã€‚è¨˜å·ã‚„ç©ºç™½æ–‡å­—ã«ã¯ãƒãƒƒãƒã—ãªã„

3ã¤ã®ã€Œã¾ãŸã¯ã€ï¼ˆ ``|`` ï¼‰
--------------------------------------------------

* ``^``
* ``[^\\p{L}\\p{N}\']``
* ``((^|\\P{L})\')``

ã“ã‚Œã‚‰ã®ã‚ã¨ã« ``\\p{L}`` ãŒç¶šã

(1) ``^`` å…¥åŠ›ã®å…ˆé ­
--------------------------------------------------

* mãƒ•ãƒ©ã‚°ã§ã€Œ*æ”¹è¡Œæ–‡å­—ã®ç›´å¾Œã«ã‚‚ä¸€è‡´*ã€
* ``'(^)\\p{L}'`` ã¯ **å…ˆé ­ã®æ–‡å­—** ã«ä¸€è‡´ï¼ˆ ``'hello world'`` ã® ``'h'`` ï¼‰

MDN `å¢ƒç•Œå‹ã®ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ <https://developer.mozilla.org/ja/docs/Web/JavaScript/Guide/Regular_expressions/Assertions#%E5%A2%83%E7%95%8C%E5%9E%8B%E3%81%AE%E3%82%A2%E3%82%B5%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3>`__

(2) æ–‡å­—ã‚¯ãƒ©ã‚¹ ``[^\\p{L}\\p{N}\']``
--------------------------------------------------

* å¦å®šã® ``^``
* ã€ŒUnicodeã§Letterã¾ãŸã¯Numberã€ã¾ãŸã¯ã‚·ãƒ³ã‚°ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆã€ **ã§ãªã„**
* ``([^\\p{L}\\p{N}\'])\\p{L}`` ã¯ ``'hello world'`` ã® ``' w'`` ã«ãƒãƒƒãƒ

MDN `æ–‡å­—ã‚¯ãƒ©ã‚¹ ç¨®é¡ <https://developer.mozilla.org/ja/docs/Web/JavaScript/Guide/Regular_expressions/Character_classes#%E7%A8%AE%E9%A1%9E>`__

(3) ``((^|\\P{L})\')``
--------------------------------------------------

* ``\P{L}`` ã¯ã€ ``\p{L}`` ã®å¦å®šï¼ˆã™ãªã‚ã¡ã€ **æ–‡å­—ã§ãªã„** ï¼‰

    * ``(^|\\P{L})`` ï¼šå…ˆé ­ã€ã¾ãŸã¯ã€æ–‡å­—ã§ãªã„

``((^|\\P{L})\')\\p{L}`` ãŒãƒãƒƒãƒã™ã‚‹ã‚‚ã®
--------------------------------------------------

* ``'\'physician\'s assistant\''`` ã§ ``'\'p'`` ã«ãƒãƒƒãƒï¼ˆå…ˆé ­ã®æ–¹ãŒãƒãƒƒãƒï¼‰
* ``'hello \'world'`` ã® ``' \'w'`` ã«ã‚‚ãƒãƒƒãƒï¼ˆæ–‡å­—ã§ãªã„æ–¹ãŒãƒãƒƒãƒï¼‰

ã“ã®æ­£è¦è¡¨ç¾ã®åã¯ ``titleBoundary``
======================================================================

* ã‚¿ã‚¤ãƒˆãƒ«ã‚±ãƒ¼ã‚¹ã«ã™ã‚‹ä¸Šã§ã® **å¢ƒç•Œ**
* ``'hello world'`` ã§ã‚ã‚Œã°ã€å¢ƒç•Œã«ä¸€è‡´ã™ã‚‹éƒ¨åˆ†æ–‡å­—åˆ—ã¯ ``'h'`` ã¨ ``' w'``

ğŸŒ¯è¦ç‚¹ï¼šã‚¿ã‚¤ãƒˆãƒ«ã‚±ãƒ¼ã‚¹ã®å¢ƒç•Œéƒ¨åˆ†ã‚’å¤§æ–‡å­—ã«ã™ã‚‹
--------------------------------------------------

1. ãƒ†ã‚­ã‚¹ãƒˆå…¨ä½“ã‚’ **å°æ–‡å­—** ã«ã™ã‚‹
2. ã‚¿ã‚¤ãƒˆãƒ«ã‚±ãƒ¼ã‚¹ã® **å¢ƒç•Œéƒ¨åˆ†** ã‚’ **å¤§æ–‡å­—** ã«ã™ã‚‹

.. code-block:: typescript

    // https://github.com/microsoft/vscode/blob/1.88.1/src/vs/editor/contrib/linesOperations/browser/linesOperations.ts#L1152-L1154
    return text
            .toLocaleLowerCase()
            .replace(titleBoundary, (b) => b.toLocaleUpperCase());

æ‹™ãƒ–ãƒ­ã‚°ã‚ˆã‚Š ğŸƒâ€â™‚ï¸
--------------------------------------------------

* `JavaScriptã®æ­£è¦è¡¨ç¾ã®ã‚³ãƒ¼ãƒ‰ã«è¦‹ãŸ\\pã‚„\\Pã£ã¦ä½•ã ï¼Ÿ Unicodeæ–‡å­—ã‚¯ãƒ©ã‚¹ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ï¼ <https://nikkie-ftnext.hatenablog.com/entry/regex-unicode-character-class-escape-javascript-python>`__
* `VS Codeã§ã€ŒTransform to Title Caseã€ã‚’æ‹…å½“ã™ã‚‹TitleCaseActionã®å®Ÿè£…ã®ä¸­ã®æ­£è¦è¡¨ç¾ã‚’èª­ã¿è§£ã <https://nikkie-ftnext.hatenablog.com/entry/understand-vscode-title-case-action-implementation-regex>`__
